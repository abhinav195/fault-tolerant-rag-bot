============================================================
    RAG BOT - QUICK TEST (5 Questions)
============================================================
Clearing and re-indexing...
{"status":"success","message":"Cleared 0 chunks from database","current_count":0}{"status":"success","url":"https://en.wikipedia.org/wiki/Artificial_intelligence","chunks_created":266,"total_characters":211487,"api_keys_used":3,"fault_tolerance":"enabled","rate_limit":"45 req/min"}
=== TEST 1: EASY (Should succeed in 1 attempt) ===
{"question":"What is AI?","answer":"Artificial intelligence (AI) is the capability of computational systems to perform tasks typically associated with human intelligence, such as learning, reasoning, problem-solving, perception, and decision-making. It is a field of research in computer science that develops and studies methods and software that enable machines to perceive their environment and use learning and intelligence to take actions that maximize their chances of achieving defined goals.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.537,0.543,0.548,0.569,0.573],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

=== TEST 2: MEDIUM (Should succeed in 1-2 attempts) ===
{"question":"What is the difference between ML and DL?","answer":"Deep learning is a subset of machine learning, which is itself a subset of artificial intelligence.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.614,0.623,0.64,0.659,0.665],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

=== TEST 3: HARD (May retry 2-3 times) ===
{"question":"What are the ethical implications of AGI?","answer":"Could not find high-quality relevant results after 3 search attempts and 2 answer attempts. Please try:\n1. Crawling more relevant URLs\n2. Rephrasing your question\n3. Asking about topics covered in the indexed content","documents_used":10,"search_attempts":3,"answer_attempts":2,"max_attempts":3,"similarity_scores":[0.553,0.562,0.565,0.568,0.581],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

=== TEST 4: IMPOSSIBLE (Should refuse gracefully) ===
{"question":"What is quantum computing?","answer":"I don't have enough information to answer this question based on the crawled content.","documents_used":10,"search_attempts":3,"answer_attempts":3,"max_attempts":3,"similarity_scores":[0.708,0.749,0.766,0.785,0.796],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

=== TEST 5: FALLBACK (Clear DB first) ===
{"status":"success","message":"Cleared 266 chunks from database","current_count":0}{"question":"What is AI?","answer":"Could not find high-quality relevant results after 3 search attempts and 0 answer attempts. Please try:\n1. Crawling more relevant URLs\n2. Rephrasing your question\n3. Asking about topics covered in the indexed content","documents_used":0,"search_attempts":3,"answer_attempts":0,"max_attempts":3,"similarity_scores":[],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

DONE! Check console output and LangSmith traces.
Press any key to continue . . .

C:\FS Projects\RAG Q&A Support Bot>test_rag.bat
============================================================
RAG BOT - COMPREHENSIVE TEST SUITE v2.0
============================================================

This will test all flow scenarios:
1. Perfect Flow (1 search, 1 answer)
2. Search Retry Flow (2-3 searches)
3. Answer Quality Retry Flow (re-search after bad answer)
4. Final Fallback Flow (all retries exhausted)
5. Edge Cases

Press any key to continue . . .

============================================================
STEP 1: CLEARING DATABASE
============================================================
{"status":"success","message":"Cleared 0 chunks from database","current_count":0}
============================================================
STEP 2: CRAWLING WIKIPEDIA ARTICLES (4 sources)
============================================================
[1/4] Crawling Artificial Intelligence...
{"status":"success","url":"https://en.wikipedia.org/wiki/Artificial_intelligence","chunks_created":266,"total_characters":211487,"api_keys_used":3,"fault_tolerance":"enabled","rate_limit":"45 req/min"}
[2/4] Crawling Machine Learning...
{"status":"success","url":"https://en.wikipedia.org/wiki/Machine_learning","chunks_created":159,"total_characters":122843,"api_keys_used":3,"fault_tolerance":"enabled","rate_limit":"45 req/min"}
[3/4] Crawling Deep Learning...
{"status":"success","url":"https://en.wikipedia.org/wiki/Deep_learning","chunks_created":171,"total_characters":136028,"api_keys_used":3,"fault_tolerance":"enabled","rate_limit":"45 req/min"}
[4/4] Crawling Neural Networks...
{"status":"success","url":"https://en.wikipedia.org/wiki/Neural_network_(machine_learning)","chunks_created":178,"total_characters":141741,"api_keys_used":3,"fault_tolerance":"enabled","rate_limit":"45 req/min"}
============================================================
STEP 3: VERIFYING DATABASE STATISTICS
============================================================
{"total_chunks":774,"unique_sources":4,"indexed_urls":["https://en.wikipedia.org/wiki/Deep_learning","https://en.wikipedia.org/wiki/Neural_network_(machine_learning)","https://en.wikipedia.org/wiki/Artificial_intelligence","https://en.wikipedia.org/wiki/Machine_learning"],"embedding_model":"models/gemini-embedding-001","llm_model":"gemini-2.5-flash-lite","vector_db":"ChromaDB (local persistent)","chunk_size":1000,"chunk_overlap":200,"api_keys_loaded":3,"fault_tolerance":"enabled (embeddings + LLM + persistent keys + smart retry)","rate_limit":"45 requests/minute","log_file":"logs/rag_bot_20260128_081350.log","current_keys":{"embedding":1,"llm":1,"search":1}}

Press any key to continue . . .

============================================================
SCENARIO 1: PERFECT FLOW - EASY QUESTIONS
Expected: search -> summarize -> validate -> END
============================================================

[Q1.1] What is artificial intelligence?
{"question":"What is artificial intelligence?","answer":"Artificial intelligence (AI) is the capability of computational systems to perform tasks typically associated with human intelligence, such as learning, reasoning, problem-solving, perception, and decision-making. It is a field of research in computer science that develops and studies methods and software that enable machines to perceive their environment and use learning and intelligence to take actions that maximize their chances of achieving defined goals.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.545,0.55,0.552,0.56,0.572],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q1.2] What is machine learning?
{"question":"What is machine learning?","answer":"Machine learning (ML) is a field of study in artificial intelligence concerned with the development and study of statistical algorithms that can learn from data and generalize to unseen data, and thus perform tasks without explicit instructions.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.523,0.555,0.561,0.564,0.564],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q1.3] What is deep learning?
{"question":"What is deep learning?","answer":"Deep learning is a subset of machine learning, which is itself a subset of artificial intelligence. It uses several layers of neurons between the network's inputs and outputs. These multiple layers can progressively extract higher-level features from the raw input. For example, in image processing, lower layers may identify edges, while higher layers may identify concepts relevant to a human such as digits, letters, or faces.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.497,0.504,0.508,0.516,0.529],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q1.4] What are neural networks?
{"question":"What are neural networks?","answer":"Neural networks, also known as artificial neural networks (ANNs) or neural nets, are computational models inspired by the structure and functions of biological neural networks. They are computing systems vaguely inspired by the biological neural networks that constitute animal brains. Such systems \"learn\" to perform tasks by considering examples, generally without being programmed with any task-specific rules.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.498,0.506,0.51,0.512,0.518],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

Press any key to continue . . .

============================================================
SCENARIO 2: MEDIUM DIFFICULTY - COMPARISONS
Expected: search -> summarize -> validate -> END
============================================================

[Q2.1] What is the difference between ML and DL?
{"question":"What is the difference between machine learning and deep learning?","answer":"Deep learning is a subset of machine learning. In deep learning, features are not hand-crafted and the model discovers useful feature representations from the data automatically. Prior to deep learning, machine learning techniques often involved hand-crafted feature engineering to transform the data into a more suitable representation for a classification algorithm to operate on.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.532,0.555,0.556,0.576,0.576],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q2.2] How do neural networks relate to deep learning?
{"question":"How do neural networks relate to deep learning?","answer":"Deep learning utilizes multilayered neural networks to perform tasks such as classification, regression, and representation learning. The field revolves around stacking artificial neurons into layers and training them to process data. In contrast to single-layer networks like perceptrons, deep learning uses many layers.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.514,0.52,0.523,0.526,0.536],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q2.3] What are the main applications of AI?
{"question":"What are the main applications of artificial intelligence?","answer":"The main applications of artificial intelligence include advanced web search engines (e.g., Google Search); recommendation systems (used by YouTube, Amazon, and Netflix); virtual assistants (e.g., Google Assistant, Siri, and Alexa); autonomous vehicles (e.g., Waymo); generative and creative tools (e.g., language models and AI art); and superhuman play and analysis in strategy games (e.g., chess and Go).","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.463,0.508,0.511,0.515,0.526],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

Press any key to continue . . .

============================================================
SCENARIO 3: HARD QUESTIONS - MULTI-CONCEPT SYNTHESIS
Expected: May trigger 1-2 retries
============================================================

[Q3.1] How do GPUs relate to the AI boom?
{"question":"How do GPUs and deep learning relate to the recent AI boom?","answer":"By 2019, graphics processing units (GPUs), often with AI-specific enhancements, had displaced CPUs as the dominant method for training large-scale commercial cloud AI. Funding and interest vastly increased after 2012 when graphics processing units started being used to accelerate neural networks, and deep learning outperformed previous AI techniques. This growth accelerated further after 2017 with the transformer architecture. In the 2020s, an ongoing period of rapid progress in advanced generative AI became known as the AI boom.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.489,0.497,0.52,0.522,0.524],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q3.2] Explain transformer architecture
{"question":"What role do transformers play in modern AI language models?","answer":"Transformers have increasingly become the model of choice for natural language processing. Many modern large language models such as ChatGPT, GPT-4, and BERT use this architecture.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.533,0.58,0.603,0.618,0.622],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q3.3] Ethical concerns about AI
{"question":"What are the main ethical concerns about artificial intelligence?","answer":"The main ethical concerns about artificial intelligence include algorithmic biases, fairness, accountability, transparency, privacy, and regulation. It also covers machine ethics, lethal autonomous weapon systems, arms race dynamics, AI safety and alignment, technological unemployment, AI-enabled misinformation, and how to treat certain AI systems if they have a moral status. Additionally, there are concerns about AI's long-term effects and potential existential risks.","documents_used":7,"search_attempts":2,"answer_attempts":1,"max_attempts":3,"similarity_scores":[0.495,0.515,0.545,0.548,0.548],"answer_quality_good":true,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

Press any key to continue . . .

============================================================
SCENARIO 4: VERY HARD - PARTIAL INFORMATION
Expected: Multiple retries, may get partial answer
============================================================

[Q4.1] Philosophical implications of AGI consciousness
{"question":"What are the philosophical implications of consciousness in artificial general intelligence?","answer":"Could not find high-quality relevant results after 3 search attempts and 2 answer attempts. Please try:\n1. Crawling more relevant URLs\n2. Rephrasing your question\n3. Asking about topics covered in the indexed content","documents_used":10,"search_attempts":3,"answer_attempts":2,"max_attempts":3,"similarity_scores":[0.544,0.565,0.572,0.586,0.596],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q4.2] Quantum computing integration
{"question":"How does quantum computing enhance neural network optimization?","answer":"Could not find high-quality relevant results after 3 search attempts and 2 answer attempts. Please try:\n1. Crawling more relevant URLs\n2. Rephrasing your question\n3. Asking about topics covered in the indexed content","documents_used":10,"search_attempts":3,"answer_attempts":2,"max_attempts":3,"similarity_scores":[0.611,0.618,0.619,0.624,0.639],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q4.3] Future of AI in 2050
{"question":"What will artificial intelligence look like in 2050?","answer":"Could not find high-quality relevant results after 3 search attempts and 2 answer attempts. Please try:\n1. Crawling more relevant URLs\n2. Rephrasing your question\n3. Asking about topics covered in the indexed content","documents_used":10,"search_attempts":3,"answer_attempts":2,"max_attempts":3,"similarity_scores":[0.591,0.6,0.603,0.607,0.607],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

Press any key to continue . . .

============================================================
SCENARIO 5: EDGE CASES - UNRELATED TOPICS
Expected: Graceful refusal (no hallucination)
============================================================

[Q5.1] Quantum Computing (unrelated)
{"question":"What is quantum computing?","answer":"I don't have enough information to answer this question based on the crawled content.","documents_used":10,"search_attempts":3,"answer_attempts":3,"max_attempts":3,"similarity_scores":[0.708,0.731,0.731,0.739,0.744],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q5.2] Blockchain (unrelated)
{"question":"How does blockchain technology work?","answer":"I don't have enough information to answer this question based on the crawled content.","documents_used":10,"search_attempts":3,"answer_attempts":3,"max_attempts":3,"similarity_scores":[0.821,0.828,0.831,0.835,0.836],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q5.3] FIFA World Cup (completely unrelated)
{"question":"Who won the 2024 FIFA World Cup?","answer":"I don't have enough information to answer this question based on the crawled content.","documents_used":10,"search_attempts":3,"answer_attempts":3,"max_attempts":3,"similarity_scores":[0.807,0.809,0.809,0.818,0.821],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

[Q5.4] Capital of France (general knowledge)
{"question":"What is the capital of France?","answer":"I don't have enough information to answer this question based on the crawled content.","documents_used":10,"search_attempts":3,"answer_attempts":3,"max_attempts":3,"similarity_scores":[0.86,0.861,0.865,0.871,0.877],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

Press any key to continue . . .

============================================================
SCENARIO 6: FINAL FALLBACK TEST - EMPTY DATABASE
Expected: 3 search attempts -> final_fallback
============================================================

Clearing database to trigger final fallback...
{"status":"success","message":"Cleared 774 chunks from database","current_count":0}
[Q6.1] Test with empty database
{"question":"What is artificial intelligence?","answer":"Could not find high-quality relevant results after 3 search attempts and 0 answer attempts. Please try:\n1. Crawling more relevant URLs\n2. Rephrasing your question\n3. Asking about topics covered in the indexed content","documents_used":0,"search_attempts":3,"answer_attempts":0,"max_attempts":3,"similarity_scores":[],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

Press any key to continue . . .

============================================================
SCENARIO 7: ANSWER QUALITY VALIDATION TEST
Re-indexing data first...
============================================================

Re-crawling AI article...
{"status":"success","url":"https://en.wikipedia.org/wiki/Artificial_intelligence","chunks_created":266,"total_characters":211487,"api_keys_used":3,"fault_tolerance":"enabled","rate_limit":"45 req/min"}
[Q7.1] Testing answer quality validation
{"question":"Explain the mathematical foundations of backpropagation in deep neural networks","answer":"Could not find high-quality relevant results after 3 search attempts and 2 answer attempts. Please try:\n1. Crawling more relevant URLs\n2. Rephrasing your question\n3. Asking about topics covered in the indexed content","documents_used":10,"search_attempts":3,"answer_attempts":2,"max_attempts":3,"similarity_scores":[0.621,0.621,0.641,0.643,0.646],"answer_quality_good":false,"api_keys_available":3,"fault_tolerance":"enabled (persistent keys + smart retry)","langsmith_trace":"https://smith.langchain.com"}

Press any key to continue . . .

============================================================
FINAL DATABASE STATISTICS
============================================================
{"total_chunks":266,"unique_sources":1,"indexed_urls":["https://en.wikipedia.org/wiki/Artificial_intelligence"],"embedding_model":"models/gemini-embedding-001","llm_model":"gemini-2.5-flash-lite","vector_db":"ChromaDB (local persistent)","chunk_size":1000,"chunk_overlap":200,"api_keys_loaded":3,"fault_tolerance":"enabled (embeddings + LLM + persistent keys + smart retry)","rate_limit":"45 requests/minute","log_file":"logs/rag_bot_20260128_081350.log","current_keys":{"embedding":1,"llm":3,"search":1}}

============================================================
TEST SUITE COMPLETED!
============================================================

Check LangSmith for detailed traces:
[https://smith.langchain.com](https://smith.langchain.com)

Expected Flow Scenarios Tested:
[x] Scenario 1: Perfect flow (1 search, 1 answer)
[x] Scenario 2: Medium difficulty (comparisons)
[x] Scenario 3: Hard questions (multi-concept)
[x] Scenario 4: Very hard (partial info, retries)
[x] Scenario 5: Edge cases (graceful refusals)
[x] Scenario 6: Final fallback (empty DB, 3 retries)
[x] Scenario 7: Answer quality validation loop

============================================================
Press any key to continue . . .